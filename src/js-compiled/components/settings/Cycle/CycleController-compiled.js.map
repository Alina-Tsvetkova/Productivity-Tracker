{"version":3,"sources":["../../../../../app/components/settings/Cycle/CycleController.js"],"names":["CycleController","workTime","workIteration","shortBreak","longBreak","cycleController","subscribeOnCycle","CycleModel","receiveCycleData","data","cycleView","renderSavedCycleSettings","cycleElements","initializeCycleElements","parseInt","value","createWorkTime","target","element","DOMElementsInitializer","counters","buttonsArr","indexOf","classList","contains","parentNode","modifiedElement","getElementsByClassName","regTakeInt","changedSum","match","restrictCycleValues","getDataForCycle","add","getWorkTime","getShortBreak","totalWidth","getWorkIterations","getLongBreak","countAllWidth","elem","totalHours","totalMinutes","renderPartsCycleMinutes","countPartsCycleHours","timePoints","innerHTML","totalTime","window","innerWidth","k","smallCycleTitle","createCycleTitle","wrapperCycleTitle","createCycleWrapper","style","width","showPartsCycleHours","ElementsListener","listenToEvents","document","event","navigator","userAgent","stopPropagation","changeCycleData","createCycle","counterOfTasks","TaskList","moveToTaskList"],"mappings":"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","file":"CycleController-compiled.js","sourcesContent":["class CycleController {\r\n    constructor(workTime, workIteration, shortBreak, longBreak) {\r\n        this.workTime = +workTime;\r\n        this.workIteration = +workIteration;\r\n        this.shortBreak = +shortBreak;\r\n        this.longBreak = +longBreak;\r\n    }\r\n\r\n    runCycle() {\r\n        cycleController.subscribeOnCycle();\r\n        CycleModel.receiveCycleData();\r\n    }\r\n\r\n    get initializeCycleElements() {\r\n        return {\r\n            longBreak: document.getElementsByClassName('counter-long-time')[0],\r\n            shortBreak: document.getElementsByClassName('counter-short-break')[0],\r\n            workIteration: document.getElementsByClassName('counter-work-iteration')[0],\r\n            workTime: document.getElementsByClassName('counter-work-time')[0]\r\n        }\r\n    }\r\n\r\n    receiveCycleDataForRender (data) {\r\n        cycleView.renderSavedCycleSettings(data);\r\n    }\r\n\r\n    getDataForCycle() { // this function is needful to transfer data from document inputs to cycle object\r\n        let cycleElements = cycleController.initializeCycleElements;\r\n        this.workTime = parseInt(cycleElements.workTime.value);\r\n        this.workIteration = parseInt(cycleElements.workIteration.value);\r\n        this.shortBreak = parseInt(cycleElements.shortBreak.value);\r\n        this.longBreak = parseInt(cycleElements.longBreak.value);\r\n        cycleView.createWorkTime();\r\n    }\r\n\r\n    changeCycleData(target) {\r\n        let element = DOMElementsInitializer.counters[DOMElementsInitializer.buttonsArr.indexOf(target)];\r\n        if (target.classList.contains('dicrement') || target.parentNode.classList.contains('dicrement')) {\r\n            element = DOMElementsInitializer.counters[DOMElementsInitializer.buttonsArr.indexOf(target) % 4];\r\n        }\r\n        let modifiedElement = target.parentNode.getElementsByClassName('field')[0];\r\n        let regTakeInt = /[0-9]+/g;\r\n        if (!(element)) {\r\n            return;\r\n        }\r\n        let changedSum = element.value;\r\n        changedSum = parseInt(changedSum.match(regTakeInt));\r\n\r\n        cycleController.restrictCycleValues(target, modifiedElement, element, changedSum);\r\n        this.getDataForCycle();\r\n    }\r\n\r\n    restrictCycleValues(target, modifiedElement, element, changedSum) {\r\n        // each input has special step\r\n        if (element.classList.contains('counter-work-iteration') || element.classList.contains('counter-short-break')) {\r\n            if (target.classList.contains('increment')) changedSum++;\r\n            else changedSum--;\r\n        }\r\n\r\n        else if (element.classList.contains('counter-work-time') || element.classList.contains('counter-long-time')) {\r\n            if (target.classList.contains('increment')) changedSum += 5;\r\n            else changedSum -= 5;\r\n        }\r\n\r\n        // inputs should have it's max and min values\r\n\r\n        if (element.classList.contains('counter-work-time')) {\r\n            if (changedSum > 40 || changedSum < 15) return;\r\n        }\r\n        else if (element.classList.contains('counter-short-break')) {\r\n            if (changedSum > 15 || changedSum < 1) return;\r\n        }\r\n        else if (element.classList.contains('counter-long-time')) {\r\n            if (changedSum > 60 || changedSum < 30) return;\r\n        }\r\n\r\n        if (element.classList.contains('counter-work-iteration')) {\r\n            if (changedSum > 5 || changedSum < 1) return;\r\n            modifiedElement.value = changedSum;\r\n        }\r\n        else {\r\n            modifiedElement.value = changedSum + ' min';\r\n        }\r\n        modifiedElement.classList.add('changedData');\r\n    }\r\n\r\n    getWorkTime() {\r\n        return this.workTime;\r\n    }\r\n\r\n    getWorkIterations() {\r\n        return this.workIteration;\r\n    }\r\n\r\n    getShortBreak() {\r\n        return this.shortBreak;\r\n    }\r\n\r\n    getLongBreak() {\r\n        return this.longBreak;\r\n    }\r\n\r\n    countAllWidth() {\r\n        let workIteration = this.getWorkTime() + this.getShortBreak();\r\n        let totalWidth = (workIteration * this.getWorkIterations()) * 2 - (this.getShortBreak()) * 2 + this.getLongBreak();\r\n        return totalWidth;\r\n    }\r\n\r\n    countWorkTime() {\r\n        return (this.workTime / this.countAllWidth() * 100) + '%';\r\n    }\r\n\r\n    countLongBreak() {\r\n        return (this.longBreak / this.countAllWidth()) * 100 + '%';\r\n    }\r\n\r\n    countShortBreak() {\r\n        return (this.shortBreak / this.countAllWidth() * 100) + '%';\r\n    }\r\n\r\n    countFullCycleHours(elem) {\r\n        let workIteration = this.workTime + this.shortBreak;\r\n        let totalWidth = (workIteration * this.workIteration) - (this.shortBreak) + this.longBreak;\r\n        let totalHours = parseInt(totalWidth / 60);\r\n        let totalMinutes = parseInt(totalWidth % 60);\r\n        cycleView.renderPartsCycleMinutes(elem, 'Full cycle: ', totalHours, 'h', totalMinutes, 'm');\r\n        this.countPartsCycleHours();\r\n    }\r\n\r\n    countPartsCycleHours() {\r\n        DOMElementsInitializer.timePoints.innerHTML = '';\r\n        let totalTime = this.countAllWidth();\r\n        let totalMinutes = 30;\r\n        let totalHours = 0;\r\n        if (window.innerWidth > 640) {\r\n            for (let k = 0; k < totalTime / 30 - 1; k++) {\r\n                let smallCycleTitle = cycleView.createCycleTitle();\r\n                let wrapperCycleTitle = cycleView.createCycleWrapper();\r\n                smallCycleTitle.classList.add('smallCycleTitleStyles');\r\n                cycleView.renderPartsCycleMinutes(smallCycleTitle, totalHours, 'h', totalMinutes, 'm');\r\n                wrapperCycleTitle.style.width = (30 / totalTime) * 100 + '%';\r\n                if (totalHours == 0) {\r\n                    cycleView.renderPartsCycleMinutes(smallCycleTitle, totalMinutes, 'm');\r\n                }\r\n                if (totalMinutes % 60 == 0) {\r\n                    totalHours += 1;\r\n                    totalMinutes -= 60;\r\n                    cycleView.renderPartsCycleMinutes(smallCycleTitle, totalHours, 'h', totalMinutes, 'm');\r\n                }\r\n                if (totalMinutes == 0) {\r\n                    cycleView.renderPartsCycleMinutes(smallCycleTitle, totalHours, 'h');\r\n                }\r\n                totalMinutes += 30;\r\n                cycleView.showPartsCycleHours(smallCycleTitle, wrapperCycleTitle);\r\n            }\r\n        }\r\n        else {\r\n            for (let k = 0; k < totalTime / 60 - 1; k++) {\r\n                let smallCycleTitle = cycleView.createCycleTitle();\r\n                let wrapperCycleTitle = cycleView.createCycleWrapper();\r\n                totalHours++;\r\n                cycleView.renderPartsCycleMinutes(smallCycleTitle, totalHours, 'h');\r\n                wrapperCycleTitle.style.width = (60 / totalTime) * 100 + '%';\r\n                cycleView.showPartsCycleHours(smallCycleTitle, wrapperCycleTitle);\r\n            }\r\n        }\r\n    }\r\n\r\n    subscribeOnCycle() {\r\n        ElementsListener.listenToEvents('click', document.getElementsByClassName('increment'), function (event) {\r\n            let target = event.target.parentNode;\r\n            if (navigator.userAgent == 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0') {\r\n                target = event.target;\r\n            }\r\n            event.stopPropagation();\r\n            cycleController.changeCycleData(target);\r\n        });\r\n\r\n        ElementsListener.listenToEvents('click', document.getElementsByClassName('dicrement'), function (event) {\r\n            let target = event.target.parentNode;\r\n            if (navigator.userAgent == 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0') {\r\n                target = event.target;\r\n            }\r\n            event.stopPropagation();\r\n            cycleController.changeCycleData(target);\r\n        });\r\n        ElementsListener.listenToEvents('click', document.getElementsByClassName('save-cycle-btn'), CycleModel.createCycle);\r\n        ElementsListener.listenToEvents('click', document.getElementsByClassName('next-btn'), function () {\r\n            counterOfTasks = 0;\r\n            TaskList.moveToTaskList();\r\n        });\r\n    }\r\n\r\n}\r\n\r\nlet DOMElementsInitializer;\r\nlet cycleController = new CycleController();\r\n"]}