{"version":3,"sources":["../../../../../app/components/reports/WeekMonthReport/WeekMonthReportModel.js"],"names":["WeekMonthReportModel","quantityOfAllTasks","firebase","database","ref","RegistrationModel","getUserDataLocally","on","snapshot","forEach","childSnapshot","childData","val","key","i","j","monthChartData","chartData","name","data","k","length","setTimeout","reports","removeReportsContainers","orderByChild","equalTo","once","finishDate","dateOfFinish","priority","countPositionFromToday","weekMonthReportModel","generateFailedReportsData","monthAndCounterBinding","l","update","indexReport","counterReports","set"],"mappings":"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","file":"WeekMonthReportModel-compiled.js","sourcesContent":["class WeekMonthReportModel {\r\n\r\n    receiveReportsData() {\r\n        let quantityOfAllTasks = 0;\r\n        firebase.database().ref('users/' + RegistrationModel.getUserDataLocally() + '/reports').on(\"value\", function (snapshot) {\r\n            snapshot.forEach(function (childSnapshot) {\r\n                let childData = snapshot.val();\r\n                let key = childSnapshot.key;\r\n                for (let i = 0; i < 5; i++) {\r\n                    for (let j in childData) {\r\n                        if (j == monthChartData.chartData[i].name) {\r\n                            monthChartData.chartData[i].data = childData[j];\r\n                        }\r\n                    }\r\n                    for (let k in childData) {\r\n                        for (let i = 0; i < childData[k].length; i++) {\r\n                            quantityOfAllTasks += childData[k][i];\r\n                        }\r\n                    }\r\n                }\r\n                if (quantityOfAllTasks == 0) {\r\n                    setTimeout(function () {\r\n                        reports.removeReportsContainers();\r\n                    }, 200)\r\n\r\n                }\r\n                return key;\r\n            });\r\n        });\r\n    }\r\n\r\n    generateReportsData() {\r\n        firebase.database().ref('users/' + RegistrationModel.getUserDataLocally() + '/tasks').orderByChild(\"taskIsDone\").equalTo(true).once(\"value\", function (snapshot) {\r\n            snapshot.forEach(function (childSnapshot) {\r\n                let childData = snapshot.val();\r\n                let key = childSnapshot.key;\r\n                let finishDate = childData[key].dateOfFinish;\r\n                let priority = childData[key].priority;\r\n                monthChartData.countPositionFromToday(finishDate, priority);\r\n            });\r\n        });\r\n        weekMonthReportModel.generateFailedReportsData();\r\n    }\r\n\r\n    generateFailedReportsData() {\r\n        firebase.database().ref('users/' + RegistrationModel.getUserDataLocally() + '/tasks').orderByChild(\"taskIsDone\").equalTo(\"failed\").once(\"value\", function (snapshot) {\r\n            snapshot.forEach(function (childSnapshot) {\r\n                let childData = snapshot.val();\r\n                let key = childSnapshot.key;\r\n                let finishDate = childData[key].dateOfFinish;\r\n                let priority = childData[key].priority;\r\n                monthChartData.countPositionFromToday(finishDate, priority);\r\n            });\r\n        });\r\n    }\r\n\r\n\r\n    clearReportsBeforeFill() {\r\n        for (let key in monthAndCounterBinding) {\r\n            for (let l = 0; l <= 30; l++) {\r\n                monthAndCounterBinding[key][l] = 0;\r\n            }\r\n        }\r\n\r\n        firebase.database().ref('users/' + RegistrationModel.getUserDataLocally()).update({\r\n            reports: monthAndCounterBinding\r\n        });\r\n    }\r\n\r\n    sendUpdatedReportsData(indexReport, counterReports, priority) {\r\n        firebase.database().ref('users/' + RegistrationModel.getUserDataLocally() + '/reports/' + priority + '/' + indexReport).set(counterReports);\r\n    }\r\n}\r\n\r\nlet weekMonthReportModel = new WeekMonthReportModel();"]}